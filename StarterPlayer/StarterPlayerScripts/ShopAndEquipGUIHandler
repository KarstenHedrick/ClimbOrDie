local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local UserInputService = game:GetService("UserInputService")

local function connectGuiEvents()
	local shopGui = playerGui:WaitForChild("ShopGui")
	local equipGui = playerGui:WaitForChild("EquipmentGui")

	local shopMenu = shopGui:WaitForChild("ShopMenu")
	local equipMenu = equipGui:WaitForChild("EquipmentMenu")

	-- Show Shop
	ReplicatedStorage:WaitForChild("ShowShopGuiEvent").OnClientEvent:Connect(function()
		shopMenu.Visible = true
		equipMenu.Visible = false

		-- Ensure mouse is unlocked for interaction
		UserInputService.MouseBehavior = Enum.MouseBehavior.Default
		UserInputService.MouseIconEnabled = true
	end)

	-- Show Equipment
	ReplicatedStorage:WaitForChild("ShowEquipmentGuiEvent").OnClientEvent:Connect(function()
		equipMenu.Visible = true
		shopMenu.Visible = false
	end)
end

-- Connect once on load
connectGuiEvents()

-- Connect again after respawn
player.CharacterAdded:Connect(function()
	task.wait(1) -- Give time for PlayerGui to be reloaded
	connectGuiEvents()
end)
